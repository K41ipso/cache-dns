# Простой кэширующий DNS-сервер — Лабораторная работа

## Описание
Это простая реализация кэширующего DNS-сервера на Python. Сервер перехватывает DNS-запросы, отправляет их upstream-серверу (например, Google DNS), кэширует ответы в памяти и сохраняет их на диск для последующего использования.

Работает через UDP на порту 53 (локально) и использует 8.8.8.8:53 как сервер по умолчанию.

## Возможности

##### Кэширование записей типов:
1. A (IPv4)
2. AAAA (IPv6)
##### Автоматическое обновление TTL
##### Сохранение кэша на диск между сеансами
##### Отображение текущего состояния кэша раз в 10 секунд

## Требования

##### Python 3.7+
##### Права администратора (если запускается на порту 53)

## Установка
```bash
pip install -r requirements.txt
```
(в данном случае зависимостей нет, кроме стандартной библиотеки)

## Запуск
```bash
python dns_server.py
```
⚠️ Если вы хотите использовать порт 53 и у вас недостаточно прав, может потребоваться запускать от root или администратора.

## Как работает

1. Сервер слушает локальный адрес (127.0.0.1:53) на входящие DNS-запросы.
2. При получении запроса:
  1) Проверяет, есть ли результат в кэше.
  2) Если есть — возвращает его.
  3) Если нет — отправляет запрос на upstream-сервер.
  4) Полученный ответ сохраняется в кэш с учетом TTL.
3. Кэш очищается от устаревших записей каждые 60 секунд.
4. При завершении работы кэш сохраняется в файл dns_cache.pkl.

## Пример вывода
```
=== DNS Cache ===

Type: A
  google.com -> 142.251.42.174 (expires 2025-04-05 12:35:00)

Type: AAAA
  ipv6.google.com -> 2a00:1450:4009:815::200e (expires 2025-04-05 12:35:00)
========================================
```

## Использованные технологии

1. Сокеты (UDP)
2. Модуль struct — для парсинга/построения DNS-сообщений
3. Многопоточность
4. Кэширование в памяти + сериализация через pickle

## Автор
Попов Георгий
Студент группы КН-203
